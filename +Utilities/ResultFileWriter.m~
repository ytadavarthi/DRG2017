function ResultFileWriter(globalStudyInfo)

    vfVideoStructure = globalStudyInfo.vfVideoStructure;
    studyCoordinates = globalStudyInfo.studyCoordinates;
    numFrames = vfVideoStructure.numFrames;
    videoFileName = vfVideoStructure.fileName;
    frameRate = vfVideoStructure.frameRate;
    
    
    [a, b] = enumeration('Data.JoveLandmarks');
    numLandmarks = numel(b);
    %disp(numLandmarks)
    %disp(b)
    tableColumnLabels = {};
    tableColumnLabels{end+1} = 'FrameNumber';
    
    for i = 1:numLandmarks
       tableColumnLabels{end+1} = strcat(b{i}, '_x');
       tableColumnLabels{end+1} = strcat(b{i}, '_y');
    end
    
%      for i = 1:numel(tableColumnLabels)
%          disp(tableColumnLabels{i})
%         disp(class(tableColumnLabels{i})) 
%      end
     
    
    imageHeight = vfVideoStructure.resolution(1); %Height of image i.e. rows in image matrix
    
    coordinatesArray = zeros(numFrames, numLandmarks*2, 'double');
    morphoJCoordinatesArray = zeros(numFrames, numLandmarks*2, 'double');
    
    for frameNumberIterator = 1:numFrames
       for landmarkNumberIterator = 1:numLandmarks
           currentCoordinate = studyCoordinates.getCoordinate(frameNumberIterator, landmarkNumberIterator);
           if (isempty(currentCoordinate))
               currentCoordinate = [ 0 0 ];
           end
           coordinatesArray(frameNumberIterator, landmarkNumberIterator*2-1) = currentCoordinate(1);
           coordinatesArray(frameNumberIterator, landmarkNumberIterator*2) = currentCoordinate(2);
           
           morphoJCoordinatesArray(frameNumberIterator, landmarkNumberIterator*2-1) = currentCoordinate(1);
           morphoJCoordinatesArray(frameNumberIterator, landmarkNumberIterator*2) = imageHeight - currentCoordinate(2) + 1;
       end        
    end
    
    coordinatesArray = horzcat((1:1:numFrames)', coordinatesArray);
    morphoJCoordinatesArray= horzcat((1:1:numFrames)', morphoJCoordinatesArray);
    
    
    t1 = array2table(coordinatesArray, 'VariableNames', tableColumnLabels);
    t2 = array2table(morphoJCoordinatesArray, 'VariableNames', tableColumnLabels);
    
    
    fullVideoFileName = vfVideoStructure.fileName;
    [pathString, name, ~] = fileparts(fullVideoFileName);
    fullResultFileName = fullfile(pathString, strcat(name, '.txt'));
    Utilities.CustomPrinters.printInfo(sprintf('Writing annotation results to %s', fullResultFileName));
    
    %add kinematics frame numbers
%     tableColumnLabels2 = {'hold_position' 'ramus_mandible' 'hyoid_burst' 'ues_closure' 'at_rest'}
%     t3 = array2table(kinematicsFrameNumberArray, 'VariableNames', tableColumnLabels2);
%     fullResultFileName = fullfile(pathString, strcat(name, '2.txt'));
%     writetable(t3, fullResultFileName, 'Delimiter', '\t');

    % kinematics frame number array for timing calculations
    [m, n] = size(t2);
    
    cell1 = table2cell(t2);
    
    %Num Columns for Frame Number Information + PCR + Frame Rate
    phaseFramesNumColumns = 16;
    
    cell2 = cell(1,n);
    cell2(1, 1:phaseFramesNumColumns) = {'start_frame' 'hold_position' 'ramus_mandible' 'hyoid_burst' 'ues_closure' 'at_rest' 'end_frame' 'point1_x' 'point1_y' 'point2_x' 'point2_y' 'pixelspercm' 'frameRate' 'holdarea' 'lvc_onset' 'lvc_offset'};
    
    cell3 = cell(1,n);
    
    %if calibration points were not annotated in VFTracker, then
    %globalStudyInfo.point1 and globalStudyInfo.point1 are blank, and in
    %the next line, an error is given when MATLAB tries to index these
    %blank vectors. This if-statement will turn globalStudyInfo.point1/2
    %into a cell matrix to avoid this problem.
    if isempty(globalStudyInfo.point1) || isempty(globalStudyInfo.point2)
        globalStudyInfo.point1 = {[],[]};
        globalStudyInfo.point2 = {[],[]};
    else
        globalStudyInfo.point1 = {globalStudyInfo.point1(1),globalStudyInfo.point1(2)};
        globalStudyInfo.point2 = {globalStudyInfo.point2(1),globalStudyInfo.point2(2)};
    end
    cell3(1, 1:phaseFramesNumColumns) =   {globalStudyInfo.start_frame,   ...
                        globalStudyInfo.hold_position, ...
                        globalStudyInfo.ramus_mandible,...
                        globalStudyInfo.hyoid_burst,   ...
                        globalStudyInfo.ues_closure,   ...
                        globalStudyInfo.at_rest,       ...
                        globalStudyInfo.end_frame,     ...
                        globalStudyInfo.point1{1},     ...
                        globalStudyInfo.point1{2},     ...
                        globalStudyInfo.point2{1},     ...
                        globalStudyInfo.point2{2},     ...
                        globalStudyInfo.pixelspercm,   ...
                        frameRate, globalStudyInfo.holdarea ...
                        globalStudyInfo.lvc_onset,       ...
                        globalStudyInfo.lvc_offset};
    
    kinematics_cell = [cell2; cell3];
    totalKinematicsTable = cell2table(kinematics_cell);

%     totalCell = [cell2; cell3; tableColumnLabels; cell1];
%     totalTable = cell2table(totalCell);
    
    totalCell = [cell2; cell3; tableColumnLabels; cell1];
    totalTable = cell2table(totalCell);
    
    %writing third file instead of concatenating kinematics frame numbers
%     kinematicsFileName = fullfile(pathString, strcat(name, '_kinematics_.txt'));
%     writetable(totalKinematicsTable, kinematicsFileName, 'Delimiter', '\t', 'WriteVariableNames', false);
%     Utilities.CustomPrinters.printInfo(sprintf('Done writing Kinematics results'));

    
    %adding coordinate
    %uncomment to get concatenated file
    %writetable(totalTable, fullResultFileName, 'Delimiter', '\t', 'WriteVariableNames', false);

    %comment
    writetable(t1, fullResultFileName, 'Delimiter', '\t');
    Utilities.CustomPrinters.printInfo(sprintf('Done writing results'));
    
    morphoJFileName = fullfile(pathString, strcat(name, '_morphoj_.txt'));
    Utilities.CustomPrinters.printInfo(sprintf('Writing MorphoJ annotation results to %s', morphoJFileName));
    writetable(totalTable, morphoJFileName, 'Delimiter', '\t', 'WriteVariableNames', false);
    %writetable(t2, morphoJFileName, 'Delimiter', '\t');
    Utilities.CustomPrinters.printInfo(sprintf('Done writing results'));
    
    %Now write the tracking status in a separate MATLAB file
    trackingResultFullFileName = fullfile(pathString, strcat(name, '_tracking_status.mat'));
    savedTrackedStatus = globalStudyInfo.studyCoordinates.trackedStatus;
    save(trackingResultFullFileName, 'savedTrackedStatus');
    

end